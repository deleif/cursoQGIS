# COMANDO Fill Sinks (Wang & Liu)
 
## C√ÅLCULO DEL DEM SIN DEPRESIONES (2). 

Este m√≥dulo utiliza el algoritmo de Wang & Liu para identificar y rellenar depresiones en modelos digitales de elevaci√≥n (MDE). Mejora el modelo al preservar una pendiente descendente a lo largo de las rutas de flujo manteniendo un gradiente de pendiente m√≠nimo. Genera un MDE sin depresiones, una rejilla de direcciones de flujo y cuencas hidrogr√°ficas.Es posible combinarlo con r.fill.dir de GRASS para perfeccionar los resultados.

Presenta  problemas al procesar grandes conjuntos de datos (por ejemplo, datos LIDAR) con este m√≥dulo, para ello usar como alternativa la versi√≥n b√°sica (Fill Sinks XXL).


[Documentaci√≥n del proceso en SAGA GIS](https://saga-gis.sourceforge.io/saga_tool_doc/2.1.3/ta_preprocessor_4.html)


### Par√°metros

| Nombre              | Tipo             | Identificador | Descripci√≥n                                              | Restricciones |
|---------------------|------------------|---------------|----------------------------------------------------------|---------------|
| MDE de entrada      | Rejilla (entrada) | `ELEV`        | Modelo digital de elevaci√≥n                               | -             |
| MDE rellenado       | Rejilla (salida)  | `FILLED`      | Modelo digital de elevaci√≥n sin depresiones               | -             |
| Direcciones de flujo| Rejilla (salida)  | `FDIR`        | Direcciones de flujo calculadas (0=N, 1=NE, ..., 7=NO)    | -             |
| Cuencas hidrogr√°ficas| Rejilla (salida)  | `WSHED`       | Cuencas hidrogr√°ficas delimitadas                         | -             |
| Pendiente m√≠nima    | Punto flotante    | `MINSLOPE`    | Gradiente m√≠nimo de pendiente de celda a celda [¬∞]        | Min: 0.0      |

### Uso en l√≠nea de comandos

```bash
saga_cmd ta_preprocessor 4 -ELEV <str> [-FILLED <str>] [-FDIR <str>] [-WSHED <str>] [-MINSLOPE <str>]
```



## Pasos para usar el algoritmo Fill Sinks (Wang & Liu) de SAGA en QGIS:
- Abrir el Panel de Procesamiento: En QGIS, ve a la pesta√±a Procesos > Caja de herramientas.
- Buscar el Algoritmo: En la barra de b√∫squeda de la caja de herramientas, escribe Fill Sinks (Wang & Liu).
- Seleccionar el Algoritmo: Dentro de los resultados, bajo la secci√≥n SAGA > Terrain Analysis - Hydrology, selecciona Fill Sinks (Wang & Liu).

## üìê Par√°metro: *Minimum Slope [Degree]*

Es el valor m√≠nimo de pendiente (en grados) que el algoritmo garantiza entre celdas vecinas despu√©s del relleno.

---

### üîé ¬øQu√© significa en la pr√°ctica?

Cuando se rellenan depresiones, pueden aparecer zonas completamente planas (sin pendiente).  
Eso puede causar problemas en los c√°lculos de flujo (el agua no sabr√≠a qu√© direcci√≥n tomar).

Por eso, **SAGA impone una pendiente m√≠nima artificial** entre celdas.

**Ejemplo:**
- `0.1¬∞` (valor por defecto): asegura que ninguna celda quede totalmente plana, el agua siempre tendr√° una direcci√≥n m√≠nima de salida.
- `0.01¬∞`: el DEM se parecer√° m√°s al original (menos alteraci√≥n).
- `>1¬∞`: el terreno se ‚Äúforzar√°‚Äù m√°s, y puede deformar los resultados.

---

## üèîÔ∏è Salidas del algoritmo

### **1. Filled DEM**
- **Descripci√≥n:** DEM corregido sin depresiones.
- **Opciones:**
  - Guardarlo en archivo (`.tif`, `.sdat`, etc.)
  - O dejarlo en archivo temporal (como en la captura).
- **Uso posterior:** es el r√°ster que se emplear√° para calcular flujo, acumulaci√≥n o drenajes.

---

### **2. üîÑ Flow Directions**
- **Descripci√≥n:** salida opcional. R√°ster con la direcci√≥n de flujo desde cada celda.
- **Detalles:**
  - Cada valor indica hacia d√≥nde fluir√≠a el agua (codificado normalmente seg√∫n esquema **D8**).
  - √ötil para c√°lculos de **acumulaci√≥n de flujo** o **red de drenaje**.

---

### **3. üåä Watershed Basins**
- **Descripci√≥n:** salida opcional. R√°ster que identifica las **cuencas de drenaje** (√°reas que vierten hacia un mismo punto de salida).
- **Detalles:**
  - Cada cuenca se etiqueta con un valor entero diferente.
  - Es una forma r√°pida de obtener una **primera delimitaci√≥n de cuencas** sin ejecutar otro algoritmo adicional.

---

  
### Consideraciones:
Fill Sinks (Wang & Liu) es √∫til porque, a diferencia de otros algoritmos, tiene en cuenta el flujo de agua dentro de las depresiones y calcula rutas de drenaje cuando es necesario.

Si ya utilizaste r.fill.dir, podr√≠as comparar ambos resultados para ver cu√°l se adapta mejor a tu an√°lisis de cuencas hidrogr√°ficas.