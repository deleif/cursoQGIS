# Calculadora de Campos en QGIS

La calculadora de campospermite realizar cálculos basados en los valores de atributos existentes o en funciones definidas. Por ejemplo, se puede utilizar para determinar la longitud de una línea o la superficie de polígonos. Los resultados obtenidos pueden emplearse para actualizar un campo ya existente o para escribir en un nuevo campo, el cual puede ser virtual.

La calculadora de campos está disponible para cualquier capa que permita edición.  Si la capa no está en modo de edición, aparecerá una advertencia, y al utilizar la calculadora de campos, se activará automáticamente el modo de edición antes de realizar el cálculo.

El cuadro de diálogo de la calculadora de campos, que se basa en el diálogo **Constructor de Expresiones**, ofrece una interfaz completa para definir y aplicar una expresión a un campo existente o crear uno nuevo. Para utilizar esta herramienta, es necesario seleccionar entre las siguientes opciones:

- Aplicar el cálculo a toda la capa o solo a las entidades seleccionadas.
- Crear un nuevo campo para almacenar el cálculo o actualizar uno ya existente.

## FUNCIONES PRINCIPALES

## Funciones Geométricas

- **`$area`**: Calcula el área del elemento.
- **`$length`**: Calcula la longitud del elemento.
- **`$perimeter`**: Devuelve el perímetro del elemento.
- **`$x`**: Devuelve la coordenada Y del elemento.
- **`$y`**: Devuelve la coordenada Y del elemento.
- **`xmin(centroid($geometry))`**: Devuelve la coordenada x del centroide del polígono.
- **`ymin(centroid($geometry))`**: Devuelve la coordenada y del centroide del polígono.
  
## Funciones de Cadena de Texto

- **`length(string)`**: Devuelve la longitud de una cadena de texto.
- **`upper(string)`**: Convierte la cadena a mayúsculas.
- **`lower(string)`**: Convierte la cadena a minúsculas.
- **`substr(string, start, length)`**: Extrae una subcadena de `string` comenzando en `start` y de longitud `length`.
- **`replace(string, search, replace)`**: Reemplaza todas las apariciones de `search` en `string` con `replace`.

## Funciones Matemáticas

- **`abs(x)`**: Devuelve el valor absoluto de `x`.
- **`ceil(x)`**: Redondea `x` hacia arriba al entero más cercano.
- **`floor(x)`**: Redondea `x` hacia abajo al entero más cercano.
- **`round(x[, n])`**: Redondea `x` a `n` decimales.
- **`sqrt(x)`**: Devuelve la raíz cuadrada de `x`.
- **`pow(x, y)`**: Eleva `x` a la potencia de `y`.
- **`exp(x)`**: Devuelve el valor de `e` elevado a `x`.
- **`log(x[, base])`**: Devuelve el logaritmo de `x` en la base especificada (base natural por defecto).


## Funciones Lógicas

- **`if(condition, true_value, false_value)`**: Devuelve `true_value` si `condition` es verdadera; de lo contrario, devuelve `false_value`.
- **`case when ... then ... end`**: Permite definir múltiples condiciones en forma de una estructura de caso.

## Funciones de Fecha y Hora

- **`now()`**: Devuelve la fecha y hora actuales.
- **`date_part('part', date)`**: Devuelve una parte específica de una fecha (por ejemplo, 'year', 'month', 'day').
- **`age(date1, date2)`**: Devuelve la diferencia entre dos fechas.



## Funciones Espaciales

- **`intersects(geometry1, geometry2)`**: Devuelve verdadero si las dos geometrías se intersectan.
- **`within(geometry1, geometry2)`**: Devuelve verdadero si `geometry1` está dentro de `geometry2`.
- **`distance(geometry1, geometry2)`**: Devuelve la distancia entre dos geometrías.

## Funciones de Agregación

- **`count(expression)`**: Cuenta el número de valores no nulos de una expresión.
- **`sum(expression)`**: Suma todos los valores de una expresión.
- **`avg(expression)`**: Devuelve el promedio de los valores de una expresión.
